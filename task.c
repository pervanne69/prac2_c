/* ----------------------------------------------------*/
/* ИМЯ: Pogosian Samvel, ID пользователя: 23К0180      */
/* ДАТА: 02/10/2025                                    */
/* НАЗНАЧЕНИЕ ПРОГРАММЫ:                               */
/* Демонстрация работы процессов-родителя и потомка.   */
/* Дочерний процесс выводит строки с префиксом "child",*/
/* родитель — с префиксом "parent".                    */
/* ИМЯ ФАЙЛА: task.c                                   */
/* ----------------------------------------------------*/
/* ФУНКЦИИ:                                            */
/* ChildProcess()  – выводит 200 строк для дочернего   */
/*                   процесса.                         */
/* ParentProcess() – выводит 200 строк для родителя.   */
/* main()          – выполняет fork(), запускает       */
/*                   дочерний процесс и ждёт его,      */
/*                   затем выполняет родительский код. */
/* ----------------------------------------------------*/

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/wait.h>   /* для wait() */
#define MAX_COUNT 200

/* ----------------------------------------------------*/
/* ФУНКЦИЯ: ChildProcess                               */
/* Назначение: вывод строк дочернего процесса.         */
/* Действия:                                           */
/*  1) В цикле от 1 до MAX_COUNT печатает сообщения.   */
/* ----------------------------------------------------*/
void ChildProcess(void)
{
    for (int i = 1; i <= MAX_COUNT; i++) {
        printf("    This line is from child, value = %d\n", i);
    }
}

/* ----------------------------------------------------*/
/* ФУНКЦИЯ: ParentProcess                              */
/* Назначение: вывод строк родительского процесса.     */
/* Действия:                                           */
/*  1) В цикле от 1 до MAX_COUNT печатает сообщения.   */
/* ----------------------------------------------------*/
void ParentProcess(void)
{
    for (int i = 1; i <= MAX_COUNT; i++) {
        printf("This line is from parent, value = %d\n", i);
    }
}

/* ----------------------------------------------------*/
/* ФУНКЦИЯ: main                                       */
/* Назначение: создание дочернего процесса.            */
/* Действия:                                           */
/*  1) Вызывает fork().                                */
/*  2) Если fork() вернул 0 → выполняет ChildProcess.  */
/*  3) Родитель ждёт завершения wait() и запускает     */
/*     ParentProcess.                                  */
/* ----------------------------------------------------*/
int main(void)
{
    pid_t pid = fork();

    if (pid < 0) {
        perror("fork");
        return 1;
    }

    if (pid == 0) {
        /* Код дочернего процесса */
        ChildProcess();
    } else {
        /* Код родительского процесса */
        wait(NULL); /* ждём завершения дочернего */
        ParentProcess();
    }

    return 0;
}
